# Tether vulnerability in the transferFrom function
_The [original contract code](https://etherscan.io/address/0xe6a2c1642455ce65d07abb417a461c6e1bed47a1#code) has been changed to simplify deployment._


## Vulnerability
The vulnerability lies in the [code below](https://github.com/an-ivannikov/tether-vulnerability-in-the-transferfrom-function/blob/54ccccf6566d7a5b604ccee7c3037e11940dda5c/contracts/TetherToken.sol#L50). 
**It allows anyone to move anyone else's funds to an address that is trusted.** 
It is understood that the trusted address can be a popular DeFi smart contract such as Uniswap Router. 
_The attacker will not be able to take possession of the funds, but he will be able to move the funds of any users without permission._

```
if (isTrusted[_recipient]) {
```


### Fixing vulnerability
To fix the vulnerability, the function should be modified as follows. 
Because this function is called by the trusted contract itself. 
The trusted caller of this function is the 'spender', not the 'receiver'.

```
if (isTrusted[_msgSender()]) {
```


## Contracts
Tether USD (USDT) and Euro Tether (EURT) in various EVM based blockchains. 
One of them: 
  - Euro Tether (EURT) in Ethereum:
    - [Proxy](https://etherscan.io/address/0xC581b735A1688071A1746c968e0798D642EDE491#code);
    - [Implementation with vulnerability](https://etherscan.io/address/0xe6a2c1642455ce65d07abb417a461c6e1bed47a1#code).
