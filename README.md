# Tether vulnerability in the transferFrom function
_The [original smart contract code](https://etherscan.io/address/0xe6a2c1642455ce65d07abb417a461c6e1bed47a1#code) has been changed to simplify deployment._


## Vulnerability
The vulnerability lies in the [code below](https://github.com/an-ivannikov/tether-vulnerability-in-the-transferfrom-function/blob/54ccccf6566d7a5b604ccee7c3037e11940dda5c/contracts/TetherToken.sol#L50). 
**It allows anyone to move anyone else's funds to an address that is trusted.** 
It is understood that the trusted address can be a popular DeFi smart contract such as Uniswap Router. 
_The attacker will not be able to take possession of the funds, but he will be able to move the funds of any users without permission._

```
if (isTrusted[_recipient]) {
```


### Testing vulnerability in Goerli
[Smart contract](https://goerli.etherscan.io/address/0x9b3f0d704bc1ca1747af0ba10521ecd7d5781669#code). 
[UniswapV2Router02](https://goerli.etherscan.io/address/0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D) as trusted smart contract.
[Victim](https://goerli.etherscan.io/address/0xf85764320a50895cb83574384C6E5db75B50ABD0). 
[Attacker](https://goerli.etherscan.io/address/0xf67B866DfDCEe2c85A3c220bB6bCecE5D6F18878). 
[Transaction with an attack](https://goerli.etherscan.io/tx/0x88d6988fbf28025275119ed6b60135667e2d19b1a0d26ed9410097f5937f4695) - Funds from the address of the victim without permission are transferred by any user to the address of a trusted contract.


### Fixing vulnerability
To fix the vulnerability, the function should be modified as follows. 
Because this function is called by the trusted smart contract itself. 
The trusted caller of this function is the 'spender', not the 'recipient'.

```
if (isTrusted[_msgSender()]) {
```


## Smart contracts
Tether USD (USDT) and Euro Tether (EURT) in various EVM based blockchains. 
One of them: 
  - Euro Tether (EURT) in Ethereum:
    - [Proxy](https://etherscan.io/address/0xC581b735A1688071A1746c968e0798D642EDE491#code);
    - [Implementation with vulnerability](https://etherscan.io/address/0xe6a2c1642455ce65d07abb417a461c6e1bed47a1#code).
